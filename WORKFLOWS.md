# ATDD Harness - Workflows

## ì „ì²´ ì›Œí¬í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  /interview â”‚ â”€â”€â–¶ â”‚  /validate  â”‚ â”€â”€â–¶ â”‚                       /design                           â”‚ â”€â”€â–¶ â”‚   /gherkin  â”‚ â”€â”€â–¶ â”‚    /tdd     â”‚ â”€â”€â–¶ â”‚  /refactor  â”‚ â”€â”€â–¶ â”‚   /verify   â”‚
â”‚   Phase 1   â”‚     â”‚   Phase 2   â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚     â”‚   Phase 3   â”‚     â”‚   Phase 4   â”‚     â”‚   Phase 5   â”‚     â”‚   Phase 6   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚   /adr   â”‚â—€â”€â”€â–¶â”‚  /redteam â”‚  (ë°˜ë³µ ë£¨í”„)            â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â”‚             â”‚  â”‚ Phase2.5aâ”‚    â”‚ Phase2.5b â”‚                         â”‚           â”‚                   â”‚                   â”‚                   â”‚
       â–¼                   â–¼             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚           â–¼                   â–¼                   â–¼                   â–¼
 requirements/       validation/         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       scenarios/        Inside-Out TDD      refactoring/        reports/
   â”œâ”€ draft.md         â”œâ”€ report.md                      â”‚                                                  â”œâ”€ *.feature      1. Entity Test       â”œâ”€ log.md           â”œâ”€ verification.md
   â””â”€ log.md           â””â”€ refined.md                     â–¼                                                  â””â”€ summary.md     2. Repository Test   â””â”€ checklist.md     â””â”€ coverage/
                                                        design/
                                                          â”œâ”€ erd.md
                                                          â”œâ”€ domain.md
                                                          â”œâ”€ traceability.md
                                                          â”œâ”€ validation.md
                                                          â”œâ”€ adr/               # ADR ë¬¸ì„œë“¤
                                                          â”‚   â”œâ”€ 001-*.md
                                                          â”‚   â””â”€ index.md
                                                          â”œâ”€ redteam/           # Red Team ê²°ê³¼
                                                          â”‚   â”œâ”€ critique-*.md
                                                          â”‚   â”œâ”€ decisions.md
                                                          â”‚   â””â”€ backlog.md
                                                          â”œâ”€ *.sql
                                                          â””â”€ *.java
```

---

## Phase 1: Interview Workflow

### ì§„ì… ì¡°ê±´
- ì‚¬ìš©ìê°€ ê¸°ëŠ¥ ìš”ì²­
- ìƒˆ í”„ë¡œì íŠ¸ ì‹œì‘
- ìš”êµ¬ì‚¬í•­ ì •ë¦¬ ìš”ì²­

### ì‹¤í–‰ íë¦„

```
1. ì‚¬ìš©ì ì•„ì´ë””ì–´ ê²½ì²­
   â””â”€â–¶ "ì–´ë–¤ ê¸°ëŠ¥ì„ ë§Œë“¤ê³  ì‹¶ìœ¼ì‹ ê°€ìš”?"

2. íƒìƒ‰ ì§ˆë¬¸ (ìˆœì°¨ì )
   â”œâ”€â–¶ "ë¹„ì¦ˆë‹ˆìŠ¤ ëª©í‘œê°€ ë¬´ì—‡ì¸ê°€ìš”?"
   â”œâ”€â–¶ "ì£¼ìš” ì‚¬ìš©ìëŠ” ëˆ„êµ¬ì¸ê°€ìš”?"
   â”œâ”€â–¶ "í•µì‹¬ ê¸°ëŠ¥ì€ ë¬´ì—‡ì¸ê°€ìš”?"
   â””â”€â–¶ "ê¸°ìˆ ì  ì œì•½ì‚¬í•­ì´ ìˆë‚˜ìš”?"

3. MoSCoW ë¶„ë¥˜
   â”œâ”€â–¶ Must have (í•„ìˆ˜)
   â”œâ”€â–¶ Should have (ì¤‘ìš”)
   â”œâ”€â–¶ Could have (ì„ íƒ)
   â””â”€â–¶ Won't have (ì œì™¸)

4. ì‚°ì¶œë¬¼ ìƒì„±
   â”œâ”€â–¶ .atdd/requirements/requirements-draft.md
   â””â”€â–¶ .atdd/requirements/interview-log.md

5. ì™„ë£Œ ì•Œë¦¼
   â””â”€â–¶ "ìš”êµ¬ì‚¬í•­ ì¸í„°ë·° ì™„ë£Œ. ë‹¤ìŒ ë‹¨ê³„: /validate"
```

### ì¶œë ¥ ì˜ˆì‹œ

**requirements-draft.md**
```markdown
# ìš”êµ¬ì‚¬í•­ ì´ˆì•ˆ

## í”„ë¡œì íŠ¸ëª…
ì‚¬ìš©ì ê´€ë¦¬ ì‹œìŠ¤í…œ

## ë¹„ì¦ˆë‹ˆìŠ¤ ëª©í‘œ
- ì‚¬ìš©ì ê°€ì… ë° ê´€ë¦¬ í”„ë¡œì„¸ìŠ¤ ìë™í™”
- ë³´ì•ˆ ìˆ˜ì¤€ í–¥ìƒ

## ì‚¬ìš©ì í˜ë¥´ì†Œë‚˜
- ì¼ë°˜ ì‚¬ìš©ì: íšŒì›ê°€ì…, ë¡œê·¸ì¸, ì •ë³´ ìˆ˜ì •
- ê´€ë¦¬ì: ì‚¬ìš©ì ê´€ë¦¬, ê¶Œí•œ ë¶€ì—¬

## ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­

### Must have
- [ ] íšŒì›ê°€ì…
- [ ] ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ
- [ ] ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”

### Should have
- [ ] ì´ë©”ì¼ ì¸ì¦
- [ ] ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°

### Could have
- [ ] ì†Œì…œ ë¡œê·¸ì¸
- [ ] 2ë‹¨ê³„ ì¸ì¦

### Won't have (ì´ë²ˆ ë²„ì „)
- [ ] SSO ì—°ë™

## ë¹„ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­
- ì‘ë‹µ ì‹œê°„: 200ms ì´í•˜
- ë™ì‹œ ì‚¬ìš©ì: 1000ëª…
```

---

## Phase 2: Validate Workflow

### ì§„ì… ì¡°ê±´
- `.atdd/requirements/requirements-draft.md` ì¡´ì¬

### ì‹¤í–‰ íë¦„

```
1. ìš”êµ¬ì‚¬í•­ ë¡œë“œ
   â””â”€â–¶ Read requirements-draft.md

2. Feasibility ê²€ì¦
   â”œâ”€â–¶ ê¸°ìˆ  ìŠ¤íƒ í˜¸í™˜ì„± í™•ì¸
   â”œâ”€â–¶ ì™¸ë¶€ ì˜ì¡´ì„± í™•ì¸
   â””â”€â–¶ ì¼ì • ë‚´ êµ¬í˜„ ê°€ëŠ¥ì„± í‰ê°€

3. Completeness ê²€ì¦
   â”œâ”€â–¶ ëˆ„ë½ ìš”êµ¬ì‚¬í•­ ì²´í¬
   â”œâ”€â–¶ ì˜ˆì™¸ ì¼€ì´ìŠ¤ í™•ì¸
   â””â”€â–¶ ë¹„ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­ í™•ì¸

4. Consistency ê²€ì¦
   â”œâ”€â–¶ ìš”êµ¬ì‚¬í•­ ê°„ ì¶©ëŒ í™•ì¸
   â”œâ”€â–¶ ëª¨í˜¸í•œ í‘œí˜„ ì‹ë³„
   â””â”€â–¶ ìš©ì–´ ì¼ê´€ì„± í™•ì¸

5. Dependencies ê²€ì¦
   â”œâ”€â–¶ ì™¸ë¶€ API ì˜ì¡´ì„±
   â”œâ”€â–¶ DB ì˜ì¡´ì„±
   â””â”€â–¶ íƒ€ ì‹œìŠ¤í…œ ì—°ë™

6. ì‚°ì¶œë¬¼ ìƒì„±
   â”œâ”€â–¶ validation-report.md (PASS/FAIL)
   â””â”€â–¶ refined-requirements.md

7. ë¶„ê¸° ì²˜ë¦¬
   â”œâ”€â–¶ PASS: "ê²€ì¦ í†µê³¼. ë‹¤ìŒ ë‹¨ê³„: /design"
   â””â”€â–¶ FAIL: "ê²€ì¦ ì‹¤íŒ¨. ìš”êµ¬ì‚¬í•­ ìˆ˜ì • í•„ìš”."
```

### ê²€ì¦ ë¦¬í¬íŠ¸ ì˜ˆì‹œ

**validation-report.md**
```markdown
# ìš”êµ¬ì‚¬í•­ ê²€ì¦ ë¦¬í¬íŠ¸

## ê²€ì¦ ì¼ì‹œ
2024-01-15 14:30:00

## ê²€ì¦ ê²°ê³¼: âœ… PASS

## ì„¸ë¶€ ê²€ì¦

### 1. Feasibility
| í•­ëª© | ê²°ê³¼ | ë¹„ê³  |
|------|------|------|
| ê¸°ìˆ  ìŠ¤íƒ í˜¸í™˜ì„± | âœ… | Spring Boot 3.x í˜¸í™˜ |
| ì™¸ë¶€ ì˜ì¡´ì„± | âœ… | ì´ë©”ì¼ ì„œë¹„ìŠ¤ ì—°ë™ ê°€ëŠ¥ |
| ì¼ì • | âœ… | 2ì£¼ ë‚´ êµ¬í˜„ ê°€ëŠ¥ |

### 2. Completeness
| í•­ëª© | ê²°ê³¼ | ë¹„ê³  |
|------|------|------|
| ëˆ„ë½ ìš”êµ¬ì‚¬í•­ | âš ï¸ | ë¡œê·¸ì•„ì›ƒ ê¸°ëŠ¥ ëª…ì„¸ ë³´ì™„ í•„ìš” |
| ì˜ˆì™¸ ì¼€ì´ìŠ¤ | âœ… | ì •ì˜ë¨ |
| ë¹„ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­ | âœ… | ì‘ë‹µ ì‹œê°„, ë™ì‹œ ì‚¬ìš©ì ëª…ì‹œ |

### 3. Consistency
| í•­ëª© | ê²°ê³¼ | ë¹„ê³  |
|------|------|------|
| ì¶©ëŒ | âœ… | ì—†ìŒ |
| ëª¨í˜¸ì„± | âš ï¸ | "ë¹ ë¥¸ ì‘ë‹µ" êµ¬ì²´í™” í•„ìš” |
| ìš©ì–´ | âœ… | ì¼ê´€ë¨ |

### 4. Dependencies
| ì˜ì¡´ì„± | ê²°ê³¼ | ë¹„ê³  |
|--------|------|------|
| MySQL | âœ… | í”„ë¡œì íŠ¸ ë‚´ í¬í•¨ |
| Redis | âœ… | ì„¸ì…˜ ì €ì¥ìš© ì¶”ê°€ í•„ìš” |

## ì¡°ì¹˜ ì‚¬í•­
1. ë¡œê·¸ì•„ì›ƒ ê¸°ëŠ¥ ëª…ì„¸ ë³´ì™„
2. "ë¹ ë¥¸ ì‘ë‹µ" â†’ "200ms ì´í•˜"ë¡œ êµ¬ì²´í™”
```

---

## Phase 2.5a: ADR Workflow

### ì§„ì… ì¡°ê±´
- `.atdd/requirements/refined-requirements.md` ì¡´ì¬
- ê²€ì¦ ë¦¬í¬íŠ¸ PASS

### ì‹¤í–‰ íë¦„

```
1. ìš”êµ¬ì‚¬í•­ ë¶„ì„
   â””â”€â–¶ Read refined-requirements.md

2. ê²°ì • ì‚¬í•­ ì‹ë³„
   â”œâ”€â–¶ ê¸°ìˆ  ìŠ¤íƒ ì„ íƒ í•„ìš” ì—¬ë¶€
   â”œâ”€â–¶ ë°ì´í„° ëª¨ë¸ë§ ê²°ì • í•„ìš” ì—¬ë¶€
   â”œâ”€â–¶ API ì„¤ê³„ ê²°ì • í•„ìš” ì—¬ë¶€
   â””â”€â–¶ ì•„í‚¤í…ì²˜ ê²°ì • í•„ìš” ì—¬ë¶€

3. ADR ë²ˆí˜¸ í• ë‹¹
   â””â”€â–¶ ë‹¤ìŒ ìˆœë²ˆ í™•ì¸ (001, 002, ...)

4. ADR ì‘ì„± ê°€ì´ë“œ
   â”œâ”€â–¶ í…œí”Œë¦¿ ì œê³µ
   â”œâ”€â–¶ í•„ìˆ˜ ì„¹ì…˜ ì•ˆë‚´
   â””â”€â–¶ ì‘ì„± ì˜ˆì‹œ ì œê³µ

5. ì‚¬ìš©ì ADR ì‘ì„±
   â”œâ”€â–¶ Context: ê²°ì • ë°°ê²½ ì‘ì„±
   â”œâ”€â–¶ Decision: ê²°ì • ì‚¬í•­ ì‘ì„±
   â”œâ”€â–¶ Alternatives: ëŒ€ì•ˆ ë¶„ì„ ì‘ì„±
   â””â”€â–¶ Consequences: ê²°ê³¼ ì‘ì„±

6. ADR ì €ì¥
   â”œâ”€â–¶ .atdd/design/adr/[ë²ˆí˜¸]-[ì œëª©].md
   â””â”€â–¶ .atdd/design/adr/index.md ì—…ë°ì´íŠ¸

7. ì™„ë£Œ ì•Œë¦¼
   â””â”€â–¶ "ADR ì‘ì„± ì™„ë£Œ. ë‹¤ìŒ ë‹¨ê³„: /redteam"
```

### ADR ì‘ì„± ì˜ˆì‹œ

**001-ë°ì´í„°ë² ì´ìŠ¤-ì„ íƒ.md**
```markdown
# 001. ë°ì´í„°ë² ì´ìŠ¤ ì„ íƒ

## Status
Proposed

## Context
ì‚¬ìš©ì ê´€ë¦¬ ì‹œìŠ¤í…œì˜ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì„ íƒí•´ì•¼ í•œë‹¤.
ìš”êµ¬ì‚¬í•­:
- ë™ì‹œ ì‚¬ìš©ì 1,000ëª… ì§€ì›
- ì‘ë‹µ ì‹œê°„ 200ms ì´í•˜
- íŠ¸ëœì­ì…˜ ë¬´ê²°ì„± í•„ìš”

## Decision
MySQL 8.0ì„ ì‚¬ìš©í•œë‹¤.

## Alternatives Considered

### PostgreSQL
- ì¥ì : JSON ì§€ì› ìš°ìˆ˜, í™•ì¥ì„± ë†’ìŒ
- ë‹¨ì : íŒ€ ê²½í—˜ ë¶€ì¡±
- ì„ íƒí•˜ì§€ ì•Šì€ ì´ìœ : íŒ€ì˜ MySQL ê²½í—˜ì´ í’ë¶€í•¨

### MongoDB
- ì¥ì : ìŠ¤í‚¤ë§ˆ ìœ ì—°ì„±
- ë‹¨ì : íŠ¸ëœì­ì…˜ ì§€ì› ì œí•œì 
- ì„ íƒí•˜ì§€ ì•Šì€ ì´ìœ : ACID íŠ¸ëœì­ì…˜ í•„ìš”

## Consequences

### ê¸ì •ì 
- íŒ€ì˜ MySQL ë…¸í•˜ìš° í™œìš© ê°€ëŠ¥
- ì•ˆì •ì ì¸ ìš´ì˜ í™˜ê²½

### ë¶€ì •ì 
- ìˆ˜í‰ í™•ì¥ ì‹œ ë³µì¡ë„ ì¦ê°€

### ìœ„í—˜
- íŠ¸ë˜í”½ ê¸‰ì¦ ì‹œ ìƒ¤ë”© í•„ìš”
```

---

## Phase 2.5b: Red Team Workflow

### ì§„ì… ì¡°ê±´
- `.atdd/design/adr/*.md` ì¡´ì¬

### ì‹¤í–‰ íë¦„

```
1. ADR ë¡œë“œ
   â””â”€â–¶ Read .atdd/design/adr/*.md

2. 6ê´€ì  ë¶„ì„
   â”œâ”€â–¶ Security: ë³´ì•ˆ ì·¨ì•½ì  ê²€í† 
   â”œâ”€â–¶ Performance: ì„±ëŠ¥ ì´ìŠˆ ê²€í† 
   â”œâ”€â–¶ Scalability: í™•ì¥ì„± ê²€í† 
   â”œâ”€â–¶ Maintainability: ìœ ì§€ë³´ìˆ˜ì„± ê²€í† 
   â”œâ”€â–¶ Business: ìš”êµ¬ì‚¬í•­ ì¶©ì¡±ë„ ê²€í† 
   â””â”€â–¶ Reliability: ì‹ ë¢°ì„± ê²€í† 

3. ì´ìŠˆ ì‹ë³„
   â”œâ”€â–¶ ì ì¬ì  ë¬¸ì œ ëª©ë¡í™”
   â”œâ”€â–¶ ì‹¬ê°ë„ ë¶„ë¥˜ (HIGH/MEDIUM/LOW)
   â””â”€â–¶ ê°œì„  ì œì•ˆ ì‘ì„±

4. Critique Report ìƒì„±
   â”œâ”€â–¶ .atdd/design/redteam/critique-[ë²ˆí˜¸].md
   â””â”€â–¶ ì´ìŠˆ ìš”ì•½ í…Œì´ë¸” ì‘ì„±

5. ì‚¬ìš©ì ê²°ì • ìˆ˜ì§‘
   â”œâ”€â–¶ ê° ì´ìŠˆì— ëŒ€í•œ ê²°ì • ìš”ì²­
   â”œâ”€â–¶ ACCEPT/DEFER/REJECT ì„ íƒ
   â””â”€â–¶ .atdd/design/redteam/decisions.md ì—…ë°ì´íŠ¸

6. ë¶„ê¸° ì²˜ë¦¬
   â”œâ”€â–¶ ACCEPT ìˆìŒ â†’ ADR ìˆ˜ì • â†’ Step 1ë¡œ ëŒì•„ê°
   â”œâ”€â–¶ ëª¨ë‘ DEFER/REJECT â†’ ë‹¤ìŒ ë‹¨ê³„ ì§„í–‰
   â””â”€â–¶ ì™„ë£Œ ì•Œë¦¼
```

### Critique Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Red Team Critique                                              â”‚
â”‚  â”œâ”€â–¶ Security ì²´í¬ë¦¬ìŠ¤íŠ¸ ì‹¤í–‰                                    â”‚
â”‚  â”œâ”€â–¶ Performance ì²´í¬ë¦¬ìŠ¤íŠ¸ ì‹¤í–‰                                 â”‚
â”‚  â”œâ”€â–¶ Scalability ì²´í¬ë¦¬ìŠ¤íŠ¸ ì‹¤í–‰                                 â”‚
â”‚  â”œâ”€â–¶ Maintainability ì²´í¬ë¦¬ìŠ¤íŠ¸ ì‹¤í–‰                             â”‚
â”‚  â”œâ”€â–¶ Business ì²´í¬ë¦¬ìŠ¤íŠ¸ ì‹¤í–‰                                    â”‚
â”‚  â””â”€â–¶ Reliability ì²´í¬ë¦¬ìŠ¤íŠ¸ ì‹¤í–‰                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Critique Report ìƒì„±                                           â”‚
â”‚  â”œâ”€â–¶ ì´ìŠˆ ëª©ë¡ (ID, ê´€ì , ì‹¬ê°ë„, ì„¤ëª…, ì œì•ˆ)                     â”‚
â”‚  â”œâ”€â–¶ ìš”ì•½ í…Œì´ë¸”                                                â”‚
â”‚  â””â”€â–¶ ê¶Œì¥ ì‚¬í•­                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ì‚¬ìš©ì ê²°ì •                                                     â”‚
â”‚  â”œâ”€â–¶ ACCEPT â†’ ADR ìˆ˜ì • â†’ Critique ì¬ì‹¤í–‰                        â”‚
â”‚  â”œâ”€â–¶ DEFER â†’ Backlog ì¶”ê°€ â†’ ì§„í–‰                                â”‚
â”‚  â””â”€â–¶ REJECT â†’ ê±°ë¶€ ì‚¬ìœ  ê¸°ë¡ â†’ ì§„í–‰                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                     ëª¨ë“  ì´ìŠˆ ì²˜ë¦¬ ì™„ë£Œ
                              â”‚
                              â–¼
                      Phase 2.5: Design (Entity/Domain)
```

### Critique Report ì˜ˆì‹œ

**critique-001.md**
```markdown
# Critique Report: ADR-001

## ê°œìš”
- **ADR**: 001. ë°ì´í„°ë² ì´ìŠ¤ ì„ íƒ
- **ê²€í†  ì¼ì‹œ**: 2024-01-15 16:00:00
- **ì „ì²´ ìœ„í—˜ë„**: MEDIUM

## ì´ìŠˆ ëª©ë¡

### [SEC-1] ë¹„ë°€ë²ˆí˜¸ ì €ì¥ ë°©ì‹ ë¯¸ì •ì˜
- **ê´€ì **: Security
- **ì‹¬ê°ë„**: HIGH
- **ì„¤ëª…**: ADRì—ì„œ ë¹„ë°€ë²ˆí˜¸ ì €ì¥ ë°©ì‹ì´ ëª…ì‹œë˜ì§€ ì•ŠìŒ
- **ì˜í–¥**: í‰ë¬¸ ì €ì¥ ì‹œ ë³´ì•ˆ ì‚¬ê³  ìœ„í—˜
- **ì œì•ˆ**: bcrypt ë˜ëŠ” argon2 ì‚¬ìš© ëª…ì‹œ

### [PERF-1] ì¸ë±ìŠ¤ ì „ëµ ë¯¸ì •ì˜
- **ê´€ì **: Performance
- **ì‹¬ê°ë„**: MEDIUM
- **ì„¤ëª…**: ì£¼ìš” ì¿¼ë¦¬ íŒ¨í„´ì— ëŒ€í•œ ì¸ë±ìŠ¤ ì „ëµ ì—†ìŒ
- **ì˜í–¥**: ì‘ë‹µ ì‹œê°„ 200ms ëª©í‘œ ë‹¬ì„± ë¶ˆê°€ëŠ¥í•  ìˆ˜ ìˆìŒ
- **ì œì•ˆ**: ì´ë©”ì¼ë¡œ ì¡°íšŒé¢‘ç¹ â†’ email ì»¬ëŸ¼ ì¸ë±ìŠ¤ ì¶”ê°€

### [SCAL-1] ìƒ¤ë”© ì „ëµ ë¯¸ì •ì˜
- **ê´€ì **: Scalability
- **ì‹¬ê°ë„**: LOW
- **ì„¤ëª…**: íŠ¸ë˜í”½ ì¦ê°€ ì‹œ ìƒ¤ë”© ì „ëµì´ ì—†ìŒ
- **ì˜í–¥**: ì¥ê¸°ì ìœ¼ë¡œ í™•ì¥ì„± ì œì•½
- **ì œì•ˆ**: í–¥í›„ ADRì—ì„œ ë‹¤ë£¨ê±°ë‚˜ Backlogì— ì¶”ê°€

## ìš”ì•½

| ê´€ì  | ì´ìŠˆ ìˆ˜ | HIGH | MEDIUM | LOW |
|------|---------|------|--------|-----|
| Security | 1 | 1 | 0 | 0 |
| Performance | 1 | 0 | 1 | 0 |
| Scalability | 1 | 0 | 0 | 1 |
| Maintainability | 0 | 0 | 0 | 0 |
| Business | 0 | 0 | 0 | 0 |
| Reliability | 0 | 0 | 0 | 0 |
| **Total** | **3** | **1** | **1** | **1** |

## ê¶Œì¥ ì‚¬í•­
1. **[í•„ìˆ˜]** ë¹„ë°€ë²ˆí˜¸ ì €ì¥ ë°©ì‹ ëª…ì‹œ (bcrypt ê¶Œì¥)
2. **[ê¶Œì¥]** ì¸ë±ìŠ¤ ì „ëµ ì¶”ê°€
3. **[ì„ íƒ]** ìƒ¤ë”© ì „ëµì€ Backlogì— ì¶”ê°€
```

### ì‚¬ìš©ì ê²°ì • ì˜ˆì‹œ

**decisions.md**
```markdown
# ì‚¬ìš©ì ê²°ì • ë¡œê·¸

## ADR-001 Critique ê²°ì • (2024-01-15)

### [SEC-1] ë¹„ë°€ë²ˆí˜¸ ì €ì¥ ë°©ì‹ ë¯¸ì •ì˜
- **ê²°ì •**: ACCEPT
- **ì´ìœ **: ëª…ë°±í•œ ë³´ì•ˆ ì·¨ì•½ì 
- **ì¡°ì¹˜**: ADRì— bcrypt ì‚¬ìš© ëª…ì‹œ ì¶”ê°€

### [PERF-1] ì¸ë±ìŠ¤ ì „ëµ ë¯¸ì •ì˜
- **ê²°ì •**: ACCEPT
- **ì´ìœ **: ì„±ëŠ¥ ëª©í‘œ ë‹¬ì„±ì„ ìœ„í•´ í•„ìš”
- **ì¡°ì¹˜**: ADRì— ì¸ë±ìŠ¤ ì „ëµ ì„¹ì…˜ ì¶”ê°€

### [SCAL-1] ìƒ¤ë”© ì „ëµ ë¯¸ì •ì˜
- **ê²°ì •**: DEFER
- **ì´ìœ **: MVP ë‹¨ê³„ì—ì„œëŠ” ê³¼ë„í•œ ì—”ì§€ë‹ˆì–´ë§
- **ì¡°ì¹˜**: Backlogì— ì¶”ê°€
```

---

## Phase 2.5: Design Workflow

### ì§„ì… ì¡°ê±´
- `.atdd/requirements/refined-requirements.md` ì¡´ì¬
- ê²€ì¦ ë¦¬í¬íŠ¸ PASS

### Entity ì„¤ê³„ ì›ì¹™: Rich Domain Model

**Entityì— ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ í¬í•¨** (Anemic Domain Model ì§€ì–‘)

```java
// âŒ Anemic (í”¼í•´ì•¼ í•  íŒ¨í„´)
@Entity
public class User {
    private String email;
    private String password;
    // getter/setterë§Œ ì¡´ì¬
}

// âœ… Rich Domain Model (ê¶Œì¥)
@Entity
public class User {
    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Embedded
    private Email email;

    @Embedded
    private Password password;

    @Enumerated(EnumType.STRING)
    private UserStatus status;

    // ê¸°ë³¸ ìƒì„±ì (JPAìš©)
    protected User() {}

    // ì •ì  íŒ©í† ë¦¬ ë©”ì„œë“œ
    public static User register(Email email, Password password) {
        User user = new User();
        user.email = email;
        user.password = password;
        user.status = UserStatus.PENDING;
        return user;
    }

    // ë¹„ì¦ˆë‹ˆìŠ¤ ë©”ì„œë“œ
    public void verifyEmail() {
        if (this.status != UserStatus.PENDING) {
            throw new IllegalStateException("ì´ë¯¸ ì¸ì¦ëœ ì‚¬ìš©ìì…ë‹ˆë‹¤.");
        }
        this.status = UserStatus.ACTIVE;
    }

    public void changePassword(Password newPassword, PasswordEncoder encoder) {
        validatePasswordChange(newPassword, encoder);
        this.password = newPassword;
    }

    public boolean isActive() {
        return this.status == UserStatus.ACTIVE;
    }
}
```

### ì‹¤í–‰ íë¦„

```
1. ìš”êµ¬ì‚¬í•­ ë¶„ì„
   â””â”€â–¶ Read refined-requirements.md

2. Entity ì‹ë³„ (ëª…ì‚¬ ë¶„ì„)
   â”œâ”€â–¶ ì‚¬ìš©ì â†’ User Entity
   â”œâ”€â–¶ ê¶Œí•œ â†’ Role Entity
   â””â”€â–¶ ì„¸ì…˜ â†’ Session Entity

3. ê´€ê³„ ì •ì˜
   â”œâ”€â–¶ User : Role = N : 1
   â”œâ”€â–¶ User : Session = 1 : N
   â””â”€â–¶ ERD ì‘ì„±

4. DDL ìƒì„±
   â”œâ”€â–¶ sql/schema/001_user.sql
   â”œâ”€â–¶ sql/schema/002_role.sql
   â””â”€â–¶ sql/schema/003_session.sql

5. JPA Entity ìƒì„± (Rich Domain Model)
   â”œâ”€â–¶ User.java (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ í¬í•¨)
   â”œâ”€â–¶ Role.java
   â””â”€â–¶ Session.java

6. Bounded Context ì •ì˜
   â””â”€â–¶ User Context (íšŒì› ê´€ë¦¬)

7. Aggregate ê²½ê³„ ì„¤ì •
   â””â”€â–¶ User Aggregate: User, Session

8. [ê²€ì¦] ìš”êµ¬ì‚¬í•­-ë„ë©”ì¸ ë§¤í•‘ ê²€ì¦ â† ì‹ ê·œ
   â”œâ”€â–¶ Must Have ìš”êµ¬ì‚¬í•­ â†’ Entity ë©”ì„œë“œ/VO ë§¤í•‘ í™•ì¸
   â”œâ”€â–¶ ê²€ì¦ ê·œì¹™ â†’ @NotNull, @Size, ë¶ˆë³€ì‹ ì½”ë“œ í™•ì¸
   â””â”€â–¶ traceability-matrix.md ìƒì„±

9. [ì‹ ê·œ] SQL Sample Data ìƒì„±
   â”œâ”€â–¶ sql/data/001_user_data.sql
   â”œâ”€â–¶ sql/data/002_role_data.sql
   â””â”€â–¶ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ì¤€ìˆ˜ ë°ì´í„°

10. [ê²€ì¦] SQL Sample Data ìš”êµ¬ì‚¬í•­ ì¤€ìˆ˜ ê²€ì¦ â† ì‹ ê·œ
    â”œâ”€â–¶ NOT NULL, UNIQUE, CHECK, FK ë¬´ê²°ì„± í™•ì¸
    â”œâ”€â–¶ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ì¤€ìˆ˜ í™•ì¸
    â””â”€â–¶ design-validation-report.md ìƒì„±

11. ì‚°ì¶œë¬¼ ìƒì„±
    â”œâ”€â–¶ .atdd/design/erd.md
    â”œâ”€â–¶ .atdd/design/domain-model.md
    â”œâ”€â–¶ .atdd/design/traceability-matrix.md (ì‹ ê·œ)
    â”œâ”€â–¶ .atdd/design/design-validation-report.md (ì‹ ê·œ)
    â””â”€â–¶ Entity Classes

12. ì™„ë£Œ ì•Œë¦¼
    â””â”€â–¶ "ì„¤ê³„ ë° ê²€ì¦ ì™„ë£Œ. ë‹¤ìŒ ë‹¨ê³„: /gherkin"
```

### ê²€ì¦ Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 8: ìš”êµ¬ì‚¬í•­-ë„ë©”ì¸ ë§¤í•‘ ê²€ì¦                               â”‚
â”‚  â”œâ”€â–¶ Must Have ìš”êµ¬ì‚¬í•­ â†’ Entity ë©”ì„œë“œ/VO ë§¤í•‘ í™•ì¸             â”‚
â”‚  â”œâ”€â–¶ ê²€ì¦ ê·œì¹™ â†’ @NotNull, @Size, ë¶ˆë³€ì‹ ì½”ë“œ í™•ì¸               â”‚
â”‚  â””â”€â–¶ traceability-matrix.md ìƒì„±                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                    PASS (100% Must Have)
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 10: SQL Sample Data ê²€ì¦                                  â”‚
â”‚  â”œâ”€â–¶ NOT NULL, UNIQUE, CHECK, FK ë¬´ê²°ì„± í™•ì¸                    â”‚
â”‚  â”œâ”€â–¶ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ì¤€ìˆ˜ í™•ì¸                                    â”‚
â”‚  â””â”€â–¶ design-validation-report.md ìƒì„±                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                           PASS
                              â”‚
                              â–¼
                      Phase 3: Gherkin
```

### í•©ê²© ê¸°ì¤€

| ê²€ì¦ í•­ëª© | ê¸°ì¤€ |
|-----------|------|
| Must Have ë§¤í•‘ | 100% |
| Should Have ë§¤í•‘ | 80% ì´ìƒ |
| NOT NULL ì¤€ìˆ˜ | 100% |
| UNIQUE ì¤€ìˆ˜ | 100% |
| FK ë¬´ê²°ì„± | 100% |
| ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ | 100% |

### ERD ì˜ˆì‹œ

**erd.md**
```markdown
# ERD

## Entity Relationship Diagram

\`\`\`
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    User     â”‚       â”‚    Role     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)     â”‚       â”‚ id (PK)     â”‚
â”‚ email       â”‚       â”‚ name        â”‚
â”‚ password    â”‚       â”‚ description â”‚
â”‚ name        â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ role_id(FK) â”‚â”€â”€Nâ”€â”€1â–¶
â”‚ created_at  â”‚
â”‚ updated_at  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚1
       â”‚
       â”‚N
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Session   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)     â”‚
â”‚ user_id(FK) â”‚
â”‚ token       â”‚
â”‚ expired_at  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
\`\`\`

## í…Œì´ë¸” ì •ì˜

### User
| Column | Type | Constraints |
|--------|------|-------------|
| id | BIGINT | PK, AUTO_INCREMENT |
| email | VARCHAR(255) | NOT NULL, UNIQUE |
| password | VARCHAR(255) | NOT NULL |
| name | VARCHAR(100) | NOT NULL |
| role_id | BIGINT | FK (role.id) |
| created_at | DATETIME | NOT NULL |
| updated_at | DATETIME | NOT NULL |
| deleted_at | DATETIME | NULLABLE |
```

---

## Phase 3: Gherkin Workflow

### ì§„ì… ì¡°ê±´
- `.atdd/design/erd.md` ì¡´ì¬
- Entity í´ë˜ìŠ¤ ì¡´ì¬

### ì‹¤í–‰ íë¦„

```
1. ì…ë ¥ ë¡œë“œ
   â”œâ”€â–¶ Read refined-requirements.md
   â”œâ”€â–¶ Read erd.md
   â””â”€â–¶ Read Entity classes

2. User Story â†’ Scenario ë³€í™˜
   â”œâ”€â–¶ "íšŒì›ê°€ì…" â†’ Feature: íšŒì› ê´€ë¦¬
   â””â”€â–¶ ê° ê¸°ëŠ¥ë³„ Scenario ì‘ì„±

3. Happy Path ì‘ì„±
   â”œâ”€â–¶ ì •ìƒ íšŒì›ê°€ì…
   â”œâ”€â–¶ ì •ìƒ ë¡œê·¸ì¸
   â””â”€â–¶ ì •ìƒ ë¡œê·¸ì•„ì›ƒ

4. Exception Path ì‘ì„±
   â”œâ”€â–¶ ì¤‘ë³µ ì´ë©”ì¼ íšŒì›ê°€ì…
   â”œâ”€â–¶ ì˜ëª»ëœ ë¹„ë°€ë²ˆí˜¸ ë¡œê·¸ì¸
   â””â”€â–¶ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì´ë©”ì¼ ë¡œê·¸ì¸

5. Background ì •ì˜
   â””â”€â–¶ ê³µí†µ Given ì ˆ

6. Data Table ì„¤ê³„
   â””â”€â–¶ ë³µì¡í•œ ì…ë ¥/ì¶œë ¥ ë°ì´í„°

7. ì‚°ì¶œë¬¼ ìƒì„±
   â”œâ”€â–¶ src/test/resources/features/user.feature
   â””â”€â–¶ .atdd/scenarios/scenarios-summary.md

8. ì™„ë£Œ ì•Œë¦¼
   â””â”€â–¶ "ì‹œë‚˜ë¦¬ì˜¤ ì‘ì„± ì™„ë£Œ. ë‹¤ìŒ ë‹¨ê³„: /tdd"
```

### Feature File ì˜ˆì‹œ

**user.feature**
```gherkin
Feature: íšŒì› ê´€ë¦¬

  Background:
    Given ë°ì´í„°ë² ì´ìŠ¤ê°€ ì´ˆê¸°í™”ë˜ì–´ ìˆë‹¤
    And ë‹¤ìŒ Roleì´ ì¡´ì¬í•œë‹¤
      | id | name  |
      | 1  | USER  |
      | 2  | ADMIN |

  Scenario: ì •ìƒì ì¸ íšŒì›ê°€ì…
    When íšŒì›ê°€ì… ìš”ì²­ì„ ë³´ë‚¸ë‹¤
      | email    | password123! | name   |
      | test@test.com | password123! | í…ŒìŠ¤í„° |
    Then ìƒíƒœ ì½”ë“œ 201ë¥¼ ë°›ëŠ”ë‹¤
    And ì‘ë‹µì˜ "email" í•„ë“œëŠ” "test@test.com"ì´ë‹¤

  Scenario: ì¤‘ë³µ ì´ë©”ì¼ë¡œ íšŒì›ê°€ì…
    Given ë‹¤ìŒ ì‚¬ìš©ìê°€ ì¡´ì¬í•œë‹¤
      | id | email         | password     | name |
      | 1  | test@test.com | password123! | í…ŒìŠ¤í„° |
    When íšŒì›ê°€ì… ìš”ì²­ì„ ë³´ë‚¸ë‹¤
      | email         | password     | name   |
      | test@test.com | password456! | í…ŒìŠ¤í„°2 |
    Then ìƒíƒœ ì½”ë“œ 409ë¥¼ ë°›ëŠ”ë‹¤

  Scenario Outline: ì˜ëª»ëœ í˜•ì‹ìœ¼ë¡œ íšŒì›ê°€ì…
    When íšŒì›ê°€ì… ìš”ì²­ì„ ë³´ë‚¸ë‹¤
      | email      | password   | name       |
      | <email>    | <password> | <name>     |
    Then ìƒíƒœ ì½”ë“œ 400ë¥¼ ë°›ëŠ”ë‹¤

    Examples:
      | email          | password     | name   |
      |                | password123! | í…ŒìŠ¤í„° |
      | invalid-email  | password123! | í…ŒìŠ¤í„° |
      | test@test.com  | 123          | í…ŒìŠ¤í„° |
      | test@test.com  | password123! |        |
```

---

## Phase 4: TDD Workflow (Inside-Out)

### ì§„ì… ì¡°ê±´
- `src/test/resources/features/**/*.feature` ì¡´ì¬
- `.atdd/design/design-validation-report.md` PASS

### TDD ì‚¬ì´í´ (Inside-Out ì ‘ê·¼)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Inside-Out TDD Cycle                      â”‚
â”‚                                                           â”‚
â”‚   Layer 1: Entity (Domain Core)                           â”‚
â”‚   â”œâ”€â–¶ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸                            â”‚
â”‚   â””â”€â–¶ Entity êµ¬í˜„                                         â”‚
â”‚                                                           â”‚
â”‚   Layer 2: Repository (Persistence)                       â”‚
â”‚   â”œâ”€â–¶ CRUD í†µí•© í…ŒìŠ¤íŠ¸                                    â”‚
â”‚   â””â”€â–¶ Repository êµ¬í˜„                                     â”‚
â”‚                                                           â”‚
â”‚   Layer 3: Service (Application)                          â”‚
â”‚   â”œâ”€â–¶ ìœ ìŠ¤ì¼€ì´ìŠ¤ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸                              â”‚
â”‚   â””â”€â–¶ Service êµ¬í˜„ (Entity ìœ„ì„)                          â”‚
â”‚                                                           â”‚
â”‚   Layer 4: Controller/E2E (Interface)                     â”‚
â”‚   â”œâ”€â–¶ E2E í…ŒìŠ¤íŠ¸ (Cucumber)                               â”‚
â”‚   â””â”€â–¶ Controller êµ¬í˜„                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì‹¤í–‰ íë¦„

```
1. Feature íŒŒì¼ ë¶„ì„
   â””â”€â–¶ Read *.feature files

2. [Inside-Out] Entity ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„± (RED)
   â”œâ”€â–¶ ì •ì  íŒ©í† ë¦¬ ë©”ì„œë“œ í…ŒìŠ¤íŠ¸
   â”œâ”€â–¶ ë¶ˆë³€ì‹(Invariant) í…ŒìŠ¤íŠ¸
   â”œâ”€â–¶ ìƒíƒœ ì „ì´ í…ŒìŠ¤íŠ¸
   â””â”€â–¶ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ â†’ ì‹¤íŒ¨ í™•ì¸

3. [Inside-Out] Entity êµ¬í˜„ (GREEN)
   â”œâ”€â–¶ Rich Domain Model êµ¬í˜„
   â”œâ”€â–¶ ë¹„ì¦ˆë‹ˆìŠ¤ ë©”ì„œë“œ êµ¬í˜„
   â””â”€â–¶ Entity ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ í†µê³¼

4. [Inside-Out] Repository í†µí•© í…ŒìŠ¤íŠ¸ ì‘ì„± (RED)
   â”œâ”€â–¶ CRUD í…ŒìŠ¤íŠ¸
   â”œâ”€â–¶ Query í…ŒìŠ¤íŠ¸
   â””â”€â–¶ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ â†’ ì‹¤íŒ¨ í™•ì¸

5. [Inside-Out] Repository êµ¬í˜„ (GREEN)
   â”œâ”€â–¶ JPA Repository êµ¬í˜„
   â””â”€â–¶ Repository í†µí•© í…ŒìŠ¤íŠ¸ í†µê³¼

6. [Inside-Out] Service ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„± (RED)
   â”œâ”€â–¶ ìœ ìŠ¤ì¼€ì´ìŠ¤ í…ŒìŠ¤íŠ¸
   â”œâ”€â–¶ Mock Repository ì‚¬ìš©
   â””â”€â–¶ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ â†’ ì‹¤íŒ¨ í™•ì¸

7. [Inside-Out] Service êµ¬í˜„ (GREEN)
   â”œâ”€â–¶ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ Entityì— ìœ„ì„
   â”œâ”€â–¶ íŠ¸ëœì­ì…˜ ê´€ë¦¬
   â””â”€â–¶ Service ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ í†µê³¼

8. Step Definition ìƒì„± (RED)
   â”œâ”€â–¶ Given/When/Then ë©”ì„œë“œ ì‘ì„±
   â””â”€â–¶ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ â†’ ì‹¤íŒ¨ í™•ì¸

9. Controller êµ¬í˜„ (GREEN)
   â”œâ”€â–¶ REST API êµ¬í˜„
   â””â”€â–¶ E2E í…ŒìŠ¤íŠ¸ í†µê³¼

10. ì»¤ë²„ë¦¬ì§€ í™•ì¸
    â””â”€â–¶ 80% ì´ìƒ ë‹¬ì„±

11. ì‚°ì¶œë¬¼ ìƒì„±
    â”œâ”€â–¶ Entity Unit Tests
    â”œâ”€â–¶ Repository Integration Tests
    â”œâ”€â–¶ Service Unit Tests
    â”œâ”€â–¶ Step Definitions
    â””â”€â–¶ Production Code

12. ì™„ë£Œ ì•Œë¦¼
    â””â”€â–¶ "TDD ì™„ë£Œ. ë‹¤ìŒ ë‹¨ê³„: /refactor"
```

### Entity ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì˜ˆì‹œ

```java
@DisplayName("User Entity í…ŒìŠ¤íŠ¸")
class UserTest {

    @Test
    @DisplayName("ì •ìƒì ì¸ ì‚¬ìš©ì ë“±ë¡")
    void register_success() {
        // given
        Email email = Email.of("test@test.com");
        Password password = Password.of("password123!");

        // when
        User user = User.register(email, password);

        // then
        assertThat(user.getEmail()).isEqualTo(email);
        assertThat(user.getStatus()).isEqualTo(UserStatus.PENDING);
    }

    @Test
    @DisplayName("ì´ë©”ì¼ ì¸ì¦ ì„±ê³µ")
    void verifyEmail_success() {
        // given
        User user = User.register(Email.of("test@test.com"), Password.of("password123!"));

        // when
        user.verifyEmail();

        // then
        assertThat(user.isActive()).isTrue();
    }

    @Test
    @DisplayName("ì´ë¯¸ ì¸ì¦ëœ ì‚¬ìš©ìëŠ” ì¸ì¦ ì‹¤íŒ¨")
    void verifyEmail_alreadyVerified_throwsException() {
        // given
        User user = User.register(Email.of("test@test.com"), Password.of("password123!"));
        user.verifyEmail();

        // when & then
        assertThatThrownBy(user::verifyEmail)
            .isInstanceOf(IllegalStateException.class)
            .hasMessage("ì´ë¯¸ ì¸ì¦ëœ ì‚¬ìš©ìì…ë‹ˆë‹¤.");
    }
}
```

### í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ëª…ë ¹

```bash
# ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
./gradlew test

# í†µí•© í…ŒìŠ¤íŠ¸
./gradlew integrationTest

# E2E í…ŒìŠ¤íŠ¸ (Cucumber)
./gradlew cucumber

# ì»¤ë²„ë¦¬ì§€ ë¦¬í¬íŠ¸
./gradlew jacocoTestReport
```

---

## Phase 5: Refactor Workflow

### ì§„ì… ì¡°ê±´
- ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼
- ì»¤ë²„ë¦¬ì§€ 80% ì´ìƒ

### ì‹¤í–‰ íë¦„

```
1. ì½”ë“œ ë¡œë“œ
   â”œâ”€â–¶ Read src/main/java/**/*.java
   â””â”€â–¶ Read src/test/java/**/*.java

2. Clean Code ê²€í† 
   â”œâ”€â–¶ Meaningful Names
   â”œâ”€â–¶ Small Functions
   â”œâ”€â–¶ No Side Effects
   â”œâ”€â–¶ SOLID Principles
   â””â”€â–¶ DRY

3. DDD íŒ¨í„´ ê²€í† 
   â”œâ”€â–¶ Entity vs Value Object
   â”œâ”€â–¶ Aggregate ê²½ê³„
   â”œâ”€â–¶ Repository íŒ¨í„´
   â””â”€â–¶ Domain Events

4. ë¦¬íŒ©í† ë§ ì‹¤í–‰
   â”œâ”€â–¶ ì½”ë“œ ì •ë¦¬
   â”œâ”€â–¶ ì¤‘ë³µ ì œê±°
   â””â”€â–¶ êµ¬ì¡° ê°œì„ 

5. í…ŒìŠ¤íŠ¸ ì¬ì‹¤í–‰
   â””â”€â–¶ ë¦¬íŒ©í† ë§ í›„ì—ë„ í…ŒìŠ¤íŠ¸ í†µê³¼

6. ì‚°ì¶œë¬¼ ìƒì„±
   â”œâ”€â–¶ .atdd/refactoring/REFACTORING-log.md
   â””â”€â–¶ .atdd/refactoring/clean-code-checklist.md

7. ì™„ë£Œ ì•Œë¦¼
   â””â”€â–¶ "ë¦¬íŒ©í† ë§ ì™„ë£Œ. ë‹¤ìŒ ë‹¨ê³„: /verify"
```

### Clean Code ì²´í¬ë¦¬ìŠ¤íŠ¸ ì˜ˆì‹œ

**clean-code-checklist.md**
```markdown
# Clean Code ì²´í¬ë¦¬ìŠ¤íŠ¸

## Meaningful Names
- [x] ì˜ë„ë¥¼ ë“œëŸ¬ë‚´ëŠ” ì´ë¦„ ì‚¬ìš©
- [x] ë°œìŒ ê°€ëŠ¥í•œ ì´ë¦„
- [x] ê²€ìƒ‰ ê°€ëŠ¥í•œ ì´ë¦„
- [x] í—ê°€ë¦¬ì•ˆ í‘œê¸°ë²• ë¯¸ì‚¬ìš©

## Functions
- [x] í•¨ìˆ˜ëŠ” í•œ ê°€ì§€ ì¼ë§Œ
- [x] 20ì¤„ ì´í•˜ ìœ ì§€
- [x] ë“¤ì—¬ì“°ê¸° 2ë‹¨ê³„ ì´í•˜
- [x] ì¸ì 3ê°œ ì´í•˜

## Comments
- [x] ì£¼ì„ ëŒ€ì‹  ì½”ë“œë¡œ ì˜ë„ í‘œí˜„
- [x] ë¶ˆí•„ìš”í•œ ì£¼ì„ ì œê±°

## Formatting
- [x] ì¼ê´€ëœ ë“¤ì—¬ì“°ê¸°
- [x] ë¹ˆ ì¤„ë¡œ ê°œë… ë¶„ë¦¬
- [x] ê°€ë¡œ ê¸¸ì´ 120ì ì´í•˜

## SOLID
- [x] Single Responsibility Principle
- [x] Open/Closed Principle
- [x] Liskov Substitution Principle
- [x] Interface Segregation Principle
- [x] Dependency Inversion Principle

## DDD
- [x] Aggregate ê²½ê³„ ì ì ˆ
- [x] Value Object ë¶ˆë³€
- [x] Repository ì¸í„°í˜ì´ìŠ¤ ë„ë©”ì¸ ì–¸ì–´ ì‚¬ìš©
```

---

## Phase 6: Verify Workflow

### ì§„ì… ì¡°ê±´
- ë¦¬íŒ©í† ë§ ì™„ë£Œ
- ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼

### ì‹¤í–‰ íë¦„

```
1. ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
   â”œâ”€â–¶ ./gradlew test
   â”œâ”€â–¶ ./gradlew integrationTest
   â””â”€â–¶ ./gradlew cucumber

2. ì»¤ë²„ë¦¬ì§€ ë¶„ì„
   â”œâ”€â–¶ ./gradlew jacocoTestReport
   â””â”€â–¶ 80% ì´ìƒ í™•ì¸

3. ì½”ë“œ í’ˆì§ˆ ì²´í¬
   â”œâ”€â–¶ ./gradlew spotlessCheck
   â””â”€â–¶ 0 errors í™•ì¸

4. Gherkin ì‹œë‚˜ë¦¬ì˜¤ ì»¤ë²„ë¦¬ì§€
   â””â”€â–¶ ëª¨ë“  ì‹œë‚˜ë¦¬ì˜¤ í†µê³¼ í™•ì¸

5. ì‚°ì¶œë¬¼ ìƒì„±
   â”œâ”€â–¶ .atdd/reports/VERIFICATION-report.md
   â””â”€â–¶ .atdd/reports/coverage-report/

6. ì™„ë£Œ ì•Œë¦¼
   â””â”€â–¶ "ê²€ì¦ ì™„ë£Œ. ATDD ì‚¬ì´í´ ì¢…ë£Œ."
```

### ê²€ì¦ ë¦¬í¬íŠ¸ ì˜ˆì‹œ

**VERIFICATION-report.md**
```markdown
# ìµœì¢… ê²€ì¦ ë¦¬í¬íŠ¸

## ê²€ì¦ ì¼ì‹œ
2024-01-20 16:00:00

## ê²€ì¦ ê²°ê³¼: âœ… ALL PASS

## í…ŒìŠ¤íŠ¸ ê²°ê³¼

### Unit Tests
```
./gradlew test

BUILD SUCCESSFUL
Tests: 45, Failures: 0, Skipped: 0
```

### Integration Tests
```
./gradlew integrationTest

BUILD SUCCESSFUL
Tests: 12, Failures: 0, Skipped: 0
```

### E2E Tests (Cucumber)
```
./gradlew cucumber

BUILD SUCCESSFUL
Scenarios: 15, Passed: 15, Failed: 0
```

## ì»¤ë²„ë¦¬ì§€

| Package | Line | Branch |
|---------|------|--------|
| domain | 92% | 88% |
| application | 85% | 80% |
| interfaces | 78% | 75% |
| **Total** | **85%** | **81%** |

## ì½”ë“œ í’ˆì§ˆ
- Lint Errors: 0
- Lint Warnings: 0

## ì™„ë£Œ ì¡°ê±´ ì²´í¬ë¦¬ìŠ¤íŠ¸
- [x] ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼
- [x] ì»¤ë²„ë¦¬ì§€ â‰¥ 80%
- [x] Lint ì—ëŸ¬ 0ê°œ
- [x] ëª¨ë“  Gherkin ì‹œë‚˜ë¦¬ì˜¤ í†µê³¼

## ATDD ì‚¬ì´í´ ì™„ë£Œ ğŸ‰
```

---

## Hookì„ í†µí•œ ìë™ ì „í™˜

Hook êµ¬ì„±ìœ¼ë¡œ Phase ê°„ ìë™ ì „í™˜ ì•Œë¦¼ ì œê³µ:

```json
{
  "hooks": [
    {
      "event": "tool_use",
      "tool": "Skill",
      "when": "interview",
      "after": [
        {
          "action": "notify",
          "message": "ìš”êµ¬ì‚¬í•­ ì¸í„°ë·° ì™„ë£Œ. ë‹¤ìŒ ë‹¨ê³„: /validate"
        }
      ]
    },
    {
      "event": "tool_use",
      "tool": "Skill",
      "when": "validate",
      "after": [
        {
          "action": "read_file",
          "path": ".atdd/validation/validation-report.md",
          "check": "status == 'PASS'",
          "on_success": {
            "action": "notify",
            "message": "ê²€ì¦ í†µê³¼. ë‹¤ìŒ ë‹¨ê³„: /design"
          },
          "on_failure": {
            "action": "notify",
            "message": "ê²€ì¦ ì‹¤íŒ¨. ìš”êµ¬ì‚¬í•­ ìˆ˜ì • í•„ìš”."
          }
        }
      ]
    }
  ]
}
```
